<app-header></app-header>

<div class="dashboard-container">
  <button class="back-btn" (click)="goBack()">‚Üê ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡πÄ‡∏°‡∏ô‡∏π‡∏´‡∏•‡∏±‡∏Å</button>

  <h2 class="page-title">üìä ‡∏™‡∏£‡∏∏‡∏õ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢ License Dashboard</h2>

  <!-- üîç Filter -->
  <div class="filter-bar">
    <select [(ngModel)]="selectedYear" (change)="filterData()">
      <option value="">‡∏ó‡∏∏‡∏Å‡∏õ‡∏µ</option>
      <option *ngFor="let y of years" [value]="y">{{ y }}</option>
    </select>

    <select [(ngModel)]="selectedProgram" (change)="filterData()">
      <option value="">‡∏ó‡∏∏‡∏Å‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°</option>
      <option *ngFor="let p of programs" [value]="p">{{ p }}</option>
    </select>
  </div>

  <!-- üßæ ‡∏™‡∏£‡∏∏‡∏õ‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏° -->
  <div class="summary-cards">
    <div class="card">
      <h3>‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h3>
      <p>{{ dashboardData.totalLicense | number }} Key</p>
    </div>
    <div class="card">
      <h3>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£‡∏ó‡∏µ‡πà‡∏ã‡∏∑‡πâ‡∏≠</h3>
      <p>{{ dashboardData.totalCompany }}</p>
    </div>
    <!-- <div class="card">
      <h3>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏ó‡∏µ‡πà‡∏Ç‡∏≤‡∏¢‡πÑ‡∏î‡πâ</h3>
      <p>{{ provinces.length }}</p>
    </div> -->
  </div>

  <!-- üìà ‡∏Å‡∏£‡∏≤‡∏ü -->
  <div class="chart-section">
    <div class="chart-card">
      <h3>‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏°‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏° (‡∏à‡∏≥‡∏ô‡∏ß‡∏ô Key)</h3>
      <canvas id="barChart"></canvas>
    </div>

    <div class="chart-card">
      <h3>‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°</h3>
      <canvas id="pieChart"></canvas>
    </div>
  </div>

  <div class="chart-section">
    <div class="chart-card">
      <h3>‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏°‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏° (‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤)</h3>
      <canvas id="barChartByValue"></canvas>
    </div>

    <div class="chart-card">
      <h3>‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏° (‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤)</h3>
      <canvas id="pieChartByValue"></canvas>
    </div>
  </div>

  <div class="chart-container">
  <canvas id="barChartByYear"></canvas>
</div>


  <!-- üìã ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• -->
  <div class="table-container">
    <h3>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢</h3>
    <table class="sales-table">
      <thead>
        <tr>
          <th>‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô</th>
          <th>‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°</th>
          <th>‡πÅ‡∏û‡πá‡∏Å‡πÄ‡∏Å‡∏à</th>
          <th>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô License</th>
          <th>‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ï‡πà‡∏≠‡∏´‡∏ô‡πà‡∏ß‡∏¢</th>
          <th>‡∏£‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ß‡∏°</th>
          <th>‡∏õ‡∏µ</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let sale of paginatedSalesDetail">
          <td>{{ sale.companyName }}</td>
          <td>{{ sale.program }}</td>
          <td>{{ sale.package }}</td>
          <td>{{ sale.licenseCount }}</td>
          <td>{{ sale.price | number }}</td>
          <td>{{ sale.totalPrice | number }}</td>
          <td>{{ sale.year }}</td>
        </tr>
      </tbody>
    </table>
    <div class="pagination">
      <button (click)="prevDetailPage()" [disabled]="currentDetailPage === 1">‚Äπ</button>
      <span>‡∏´‡∏ô‡πâ‡∏≤ {{ currentDetailPage }} / {{ totalDetailPages }}</span>
      <button (click)="nextDetailPage()" [disabled]="currentDetailPage >= totalDetailPages">‚Ä∫</button>
    </div>
  </div>
</div>

<app-footer></app-footer>
